<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comparativo de HH</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Colocamos o iframe diretamente no HTML. Isso é mais simples e garantido de funcionar. -->
    <iframe id="reportIframe" title="CP - Comparativo de HH" 
            src="https://app.powerbi.com/view?r=eyJrIjoiMWViMDBkYTktNDA1MC00YzIxLWJkY2QtNTBiN2U2NDM4NGU3IiwidCI6IjNjYzQ2MDVjLWJlY2ItNGZhOC1iMmVjLTlhY2E2YzBmMjE5YSJ9" 
            frameborder="0" allowFullScreen="true">
    </iframe>

    <!-- O botão continua posicionado de forma absoluta pela folha de estilo -->
    <button id="downloadButton" style="display: none;">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" class="bi bi-camera-fill"><path d="M10.5 8.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/><path d="M2 4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-1.172a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 9.172 2H6.828a2 2 0 0 0-1.414.586l-.828.828A2 2 0 0 1 3.172 4H2zm.5 2a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1zm9 2.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0z"/></svg>
        Salvar Imagem
    </button>

    <!-- SCRIPTS NO FINAL: Garante que o HTML seja renderizado primeiro -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/powerbi-client/2.22.3/powerbi.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- O atributo 'defer' pede ao navegador para executar nosso script só depois de analisar todo o HTML -->
    <script src="script.js" defer></script>
</body>
</html>

